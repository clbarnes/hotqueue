language: python
dist: xenial
python: 3.7
env:
  - TOX_ENV=py27-redislite
  - TOX_ENV=py35-redislite
  - TOX_ENV=py36-redislite
  - TOX_ENV=py37-redislite
  - TOX_ENV=py27-redis
  - TOX_ENV=py35-redis
  - TOX_ENV=py36-redis
  - TOX_ENV=py37-redis
  - TOX_ENV=build_docs
  - TOX_ENV=pylint
  - TOX_ENV=pep8
matrix:
  fast_finish: true
  allow_failures:
    - env:
      - TOX_ENV=py27-redis
      - TOX_ENV=py35-redis
      - TOX_ENV=py36-redis
      - TOX_ENV=py37-redis
      - TOX_ENV=build_docs
      - TOX_ENV=pylint
      - TOX_ENV=pep8
before_install:
  - sudo apt-get update -qq
  - pip install tox-travis
script: tox
after_success: coveralls
after_failure:
  - for X in .tox/$TOX_ENV/log/*; do echo "$X\n"; cat "$X"; echo "\n\n"; done
  - echo "pip.log\n"; cat $HOME/.pip/pip.log
